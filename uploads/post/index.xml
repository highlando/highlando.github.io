<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Blog | Jan Heiland Personal Homepage</title>
    <link>https://www.janheiland.de/post/</link>
      <atom:link href="https://www.janheiland.de/post/index.xml" rel="self" type="application/rss+xml" />
    <description>Blog</description>
    <generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>en-us</language><lastBuildDate>Sun, 12 Feb 2023 22:00:25 +0800</lastBuildDate>
    <image>
      <url>https://www.janheiland.de/media/icon_hu2654a0fcc87c65a864822ac27b001d3b_1368_512x512_fill_lanczos_center_3.png</url>
      <title>Blog</title>
      <link>https://www.janheiland.de/post/</link>
    </image>
    
    <item>
      <title>Convolutional autoencoders for very low-dimensional parametrizations of nonlinear fluid flow</title>
      <link>https://www.janheiland.de/post/23-ldlpv-nse/</link>
      <pubDate>Sun, 12 Feb 2023 22:00:25 +0800</pubDate>
      <guid>https://www.janheiland.de/post/23-ldlpv-nse/</guid>
      <description>&lt;h1 id=&#34;introduction&#34;&gt;Introduction&lt;/h1&gt;
&lt;p&gt;The control of large-dimensional nonlinear dynamical systems is a challenging task because of the&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;system&amp;rsquo;s size that means a high demand in computational resources&lt;/li&gt;
&lt;li&gt;and the nonlinearity that adds model inherent complexity to be resolved by the controller.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;As long as the system is linear, the computational demands (1.) are well met by powerful and modern &lt;em&gt;linear algebra tools&lt;/em&gt; and specialized hardware. A nonlinearity (2.) in small dimensions can be treated through system insights or, sometimes, by repeated linearizations. If nonlinear and large-scale comes together things become tricky.&lt;/p&gt;
&lt;p&gt;Here, we try to find the way out by proposing a formulation that is&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;linear by its overall structure&lt;/li&gt;
&lt;li&gt;with the nonlinearities parametrized by just a few number of parameters.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;system-approximation-by-low-dimensional-linear-parametrizations&#34;&gt;System approximation by low-dimensional linear parametrizations&lt;/h1&gt;
&lt;p&gt;In the (nonlinear) Navier-Stokes equations that describe the evolution of fluid flow, the nonlinear term is given by the convection term in the form
&lt;/p&gt;
$$
f(v) = N(v)\, v
$$
&lt;p&gt;
where, for any velocity field $v$, the convection operator $N(v)$ describes how the velocity field itself is convected. In a simulation $N(v)$ is a matrix that multiplies the state vector $v$. Despite this matrix structure, the nonlinearity $N(v)\,v$ is deemed complex because $v$ and $N(v)$ are typically very large. If, however, one could approximately (but sufficiently accurately) parametrize $N(v)$ by, say, three scalar parameters $(\rho_1(v), \rho_2(v), \rho_3(v))$ and three basis matrices $N_1$, $N_2$, and $N_3$, i.e.
&lt;/p&gt;
$$
N(v) \approx \rho_1(v)N_1 + \rho_2(v)N_2 + \rho_3(v)N_3x
$$
&lt;p&gt;
then the nonlinearity
&lt;/p&gt;
$$
N(v)\,v \approx  \rho_1(v)N_1\,v + \rho_2(v)N_2\,v + \rho_3(v)N_3\,v
$$
&lt;p&gt;
becomes replaced by a hopefully easy computation of $\rho(v)$ and, notably, just three matrix vector multiplications &amp;ndash; the standard operation of numerical linear algebra. And the problem, as we wanted it, appears to be basically linear and only with a low dimensional nonlinearity.&lt;/p&gt;
&lt;h1 id=&#34;low-dimensional-parametrization-of-fluid-flow&#34;&gt;Low-dimensional parametrization of fluid flow&lt;/h1&gt;
&lt;p&gt;In view of parametrizing $N(v)$, we look for a low-dimensional approximative parametrization of $v$. Low-dimensional approximations of the state of dynamical systems is both the core and promise of classical model order reduction. For our application, however, we would like to trade in some accuracy for very low dimensionality for what classical model reduction techniques are notoriously unsuited.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/23-ldlpv-nse/cw-Re60-t161-cm-ctw-viridis.png&#34;
    alt=&#34;Snapshot of a developed flow behind a cylinder.&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;Snapshot of a developed flow behind a cylinder.&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Therefore, we explored how deep convolutional autoencoders (CAEs) could be of help here. CAEs have been developed and successfully used two encode images in a low-dimensional latent feature space for, e.g., classification purposes. For us, the images will be velocity states (as we would plot them, e.g., in Figure 1) and the space of latent features will provide us with a low dimensional parametrization (see Figure 2/3 of an example architecture and an illustration of the dimension reduction).&lt;/p&gt;
&lt;p&gt;Apart from providing a flexible and thanks to modern machine learning toolboxes efficiently implementable encoding and decoding mechanism, deep convolutional autoencoders seems a good choice for our tasks as&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;by the socalled &lt;em&gt;sparse connectivity&lt;/em&gt; the neural network itself requires a moderate number of parameters despite possibly large dimensions of the data&lt;/li&gt;
&lt;li&gt;the implemented operations are shift invariant, meaning a pattern will be detected equally well independent of its position (which seems a good thing to have when thinking of fluid flow)&lt;/li&gt;
&lt;li&gt;the reduction operation of &lt;em&gt;pooling&lt;/em&gt; can be seen as providing a multilevel view on the data&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/23-ldlpv-nse/caearc.png&#34;
    alt=&#34;A schematic illustration of a convolutional autoencoder.&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;A schematic illustration of a convolutional autoencoder.&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h1 id=&#34;simulation-of-low-dimensionally-parametrized-flows&#34;&gt;Simulation of low-dimensionally parametrized flows&lt;/h1&gt;
&lt;p&gt;We considered the two dimensional flow behind a round obstacle that develops a periodic shedding of vertices (see Figure 1). In our simulations, we checked if we can indeed replace the $50&#39;000$ dimensional $v$ in $N(v)$ by $\rho(v)$ with literally only $3$ components.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/23-ldlpv-nse/nse-cnn.jpg&#34;
    alt=&#34;An illustrative sketch of how the velocity field data is processed by the convolutional neural network to provide the low dimensional code $\rho$.&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;An illustrative sketch of how the velocity field data is processed by the convolutional neural network to provide the low dimensional code $\rho$.&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Since in these systems, from a local perspective, small changes can have extreme impacts, differences in the simulation are best evaluated qualitively. Therefore, instead of plotting errors between trajectories (as we did for drag and lift in Figure 4 anyways), we sketched out the &lt;em&gt;phase portrait&lt;/em&gt; of how drag and lift that the cylinder experiences evolve in the 2D plane over time.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/23-ldlpv-nse/nse-nn-ldlpv-0.png&#34;
    alt=&#34;Trajectories of drag and lift over time for the full order model and the low-order parametrized models by the convolutional neural network (CNN) and by POD of dimension $3$.&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;Trajectories of drag and lift over time for the full order model and the low-order parametrized models by the convolutional neural network (CNN) and by POD of dimension $3$.&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/23-ldlpv-nse/nse-nn-ldlpv-1.png&#34;
    alt=&#34;The phase portraits corresponding to the trajectories of drag and lift as displayed in Figure 5.&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;The phase portraits corresponding to the trajectories of drag and lift as displayed in Figure 5.&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;From Figure 5 we can observe that the CAE approach with 3 parameters well approximates the limit cycle of the full order simulation both in position in size (in particular if compared to the rather standard parametrization approach using POD).&lt;/p&gt;
&lt;h1 id=&#34;bibliography&#34;&gt;Bibliography&lt;/h1&gt;
&lt;p&gt;For further reading we recommend our paper
that has the detailed theory for this presented example application. A numerical study directed to improve the encoding with the help of clustering can be found in&lt;/p&gt;
&lt;p&gt;If you want to redo and expand on the simulations, please check out the codes that accompany the papers.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Pandoc vs. Pandemic</title>
      <link>https://www.janheiland.de/post/21-pandoc-markdown-tools/</link>
      <pubDate>Sun, 18 Apr 2021 14:36:55 +0200</pubDate>
      <guid>https://www.janheiland.de/post/21-pandoc-markdown-tools/</guid>
      <description>&lt;p&gt;While things were shifting away from &lt;em&gt;away from keyboard&lt;/em&gt;, I found little pleasures in seeing software tools in production. Most of all I enjoy small scripts&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; that take a few lines of readable text and turn it into a &lt;a href=&#34;https://www.janheiland.de/courses/mathe2info-21/&#34;&gt;website for an online course&lt;/a&gt;, into &lt;a href=&#34;https://www.janheiland.de/script-daes/basic-definitions-and-notions.html&#34;&gt;lecture notes&lt;/a&gt;, or a &lt;a href=&#34;http://www.janheiland.de/talk-gpuq/#/title-slide&#34;&gt;slide deck for presentation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This all bases on &lt;code&gt;Markdown&lt;/code&gt; text files and some interpreter and compiler. For the websites the interpreter is &lt;code&gt;hugo&lt;/code&gt;, for the lecture nodes it is &lt;code&gt;bookdown&lt;/code&gt;, and for the presentation it is &lt;code&gt;pandoc&lt;/code&gt; and &lt;code&gt;reveal.js&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The sources are conveniently edited in my favorite editor. With &lt;em&gt;syntax highlighting&lt;/em&gt; and &lt;em&gt;code concealing&lt;/em&gt;, the basic parts of the markup is partially hidden and already preinterpreted.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/21-pandoc-markdown-tools/vim-scsh.png&#34;
    alt=&#34;Screenshot of an editor with markdown support.&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;Screenshot of an editor with markdown support.&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;The final compilation and interpretation is well kept out of sight and can be automated or not on many stages.&lt;/p&gt;
&lt;p&gt;Together with other little &lt;em&gt;unix&lt;/em&gt; tools&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;, it took me just one hour to &lt;a href=&#34;https://github.com/highlando/pandoc-markdown-book-template/blob/master/RUNME.md&#34;&gt;turn my notes&lt;/a&gt; on my &lt;em&gt;natural yeast recipes&lt;/em&gt; into an &lt;em&gt;e-book&lt;/em&gt; and arrange the pdf export such that it could be printed as an &lt;a href=&#34;https://www.instructables.com/A-one-sheet-of-paper-booklet/&#34;&gt;8-page booklet on a single A4 page&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Please checkout the outcomes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;#x1f4d9; &lt;a href=&#34;lm.pdf&#34;&gt;Booklet of my recipes for baking&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&amp;#x1f4d8; &lt;a href=&#34;ready-for-print.pdf&#34;&gt;Ready to be printed and folded into a real booklet&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/21-pandoc-markdown-tools/the-booklet.jpg&#34;
    alt=&#34;The printed booklet.&#34;&gt;&lt;figcaption&gt;
      &lt;p&gt;The printed booklet.&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;Similarly exciting and helpful but on a different level are high-end open source tools like &lt;code&gt;OBS&lt;/code&gt; for screencasting and streaming or &lt;code&gt;audacity&lt;/code&gt; for podcasting.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;Namely &lt;code&gt;Okular&lt;/code&gt; for exporting epub to pdf, &lt;code&gt;pdftk&lt;/code&gt; for rotating, cutting, and arranging, and &lt;code&gt;boomaga&lt;/code&gt;&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Trends in Covid-19 Spread</title>
      <link>https://www.janheiland.de/post/covid-19-trends/</link>
      <pubDate>Sun, 22 Mar 2020 13:22:04 +0100</pubDate>
      <guid>https://www.janheiland.de/post/covid-19-trends/</guid>
      <description>&lt;h1 id=&#34;summary&#34;&gt;Summary&lt;/h1&gt;
&lt;p&gt;The John Hopkins University (JHU) collects data on how the COVID-19 virus
spreads over the world and makes it &lt;a href=&#34;https://github.com/CSSEGISandData/COVID-19&#34;&gt;available on
github&lt;/a&gt;. In this analysis, we take
the data and extract the numbers that describe how the growth of casualties
develops. Looking at the trends in these numbers, one may deduce how fast or how
slow the virus is spreading and also compare how the situation evolves in different
countries.&lt;/p&gt;
&lt;p&gt;Feel free to use the &lt;a href=&#34;https://github.com/highlando/covid-over-any-time-soon&#34;&gt;&lt;em&gt;python&lt;/em&gt;
implementation&lt;/a&gt; that
produces the presented plots and that can be modified to show the results for
any country that is in the JHU data base.&lt;/p&gt;
&lt;p&gt;This post bases on joint efforts and discussions of the &lt;a href=&#34;https://www.mpi-magdeburg.mpg.de/csc&#34;&gt;CSC
group&lt;/a&gt; at the MPI Magdeburg.&lt;/p&gt;
&lt;p&gt;The numbers in the presented plots are updated automatically&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;details class=&#34;print:hidden xl:hidden&#34; &gt;
  &lt;summary&gt;Table of Contents&lt;/summary&gt;
  &lt;div class=&#34;text-sm&#34;&gt;
  &lt;nav id=&#34;TableOfContents&#34;&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&#34;#illustrative-examples&#34;&gt;Illustrative Examples&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#general-explanations-of-the-numbers&#34;&gt;General Explanations of the Numbers&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#what-it-would-look-like-and-what-it-should-look-like&#34;&gt;What It Would Look Like and What It Should Look Like&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&#34;#the-last-100-days&#34;&gt;The last 100 days&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#the-last-30-days&#34;&gt;The last 30 days&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;

  &lt;ul&gt;
    &lt;li&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;a href=&#34;#disclaimer&#34;&gt;Disclaimer&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&#34;#acknowledgements&#34;&gt;Acknowledgements&lt;/a&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/nav&gt;
  &lt;/div&gt;
&lt;/details&gt;
&lt;h1 id=&#34;why-this-analysis&#34;&gt;Why This Analysis&lt;/h1&gt;
&lt;p&gt;If one looks at the actual numbers generated by an exponential growth, the
overall growth is so strong, that one barely sees changes in the dynamics. If
one looks at the numbers in log scale, the data becomes more handy. In log scale
an exponential growth looks like a straight line and the slope of the line
indicates how fast the exponential growth is.&lt;/p&gt;
&lt;p&gt;To see whether the exponential growth changes its dynamics, one may check
whether the line in the logarithmic plot changes its slope (&lt;em&gt;hopefully it gets
less steep&lt;/em&gt;). That&amp;rsquo;s why we plot the slope of the logarithmic line that connects
the numbers of two consecutive days. Since the data is wiggly, we also plot
averages of the slopes over 2 or 5 days to better spot the trends.&lt;/p&gt;
&lt;p&gt;This post was inspired by an illustration that was discussed on twitter&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt; in the
last days:
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/covid-19-trends/ricci-tersenghi.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;Lockdowns and the numbers of deaths in Italy and Hubei&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

It shows how, seemingly, the exponential growth in casualties did decrease some
days after lockdowns have been implemented. In this analysis, we try to
automatically detect such changes in the growth for a number of countries and
represent it in an accessible form that allows easy comparisons.&lt;/p&gt;
&lt;h1 id=&#34;the-analysis&#34;&gt;The Analysis&lt;/h1&gt;
&lt;p&gt;We examine the (logarithmic) slope of the curves of the accumulated cases
per day.  That is for day &lt;code&gt;d&lt;/code&gt; and the day &lt;code&gt;d-1&lt;/code&gt; before that day, we look at &lt;code&gt;log2(x[d]) - log2(x[d-1])&lt;/code&gt;, where &lt;code&gt;x&lt;/code&gt; holds the number of accumulated deaths for every day
and where &lt;code&gt;log2&lt;/code&gt; is a function that computes the logarithm of a number with
respect to the basis&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt; &lt;code&gt;2&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The resulting slope is exactly the daily increase in the number of cases in
relation to the overall number of cases. As this is easier to interprete,
we translate the slopes into the daily increase in percent.&lt;/p&gt;
&lt;h2 id=&#34;illustrative-examples&#34;&gt;Illustrative Examples&lt;/h2&gt;
&lt;p&gt;To make sense of the numbers, we start with some example scenarios. In the plot
below, we have plotted the values for some &lt;em&gt;fictitious&lt;/em&gt; growth scenarios.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;An exponential growth &amp;ndash; every day &lt;code&gt;d&lt;/code&gt; the number of additional cases is
&lt;code&gt;1.1**d&lt;/code&gt; (&lt;em&gt;speak: &lt;code&gt;1.1&lt;/code&gt; to the power of &lt;code&gt;d&lt;/code&gt; and think of a daily increase by
10%&lt;/em&gt;). This scenario leads to a constant value in the plots of around &lt;code&gt;0.14&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A constant growth &amp;ndash; every day another &lt;code&gt;10&lt;/code&gt; cases are added. This is
like the number of daily deaths due to traffic incidents in Germany&lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt; in 2010.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A growth that decreases exponentially &amp;ndash; every day the number of additional
cases gets smaller exponentially.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/covid-19-trends/slopes-examples.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;The daily increase of the accumulated cases for the example scenarios&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;general-explanations-of-the-numbers&#34;&gt;General Explanations of the Numbers&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;A &lt;strong&gt;constant&lt;/strong&gt; value means that the number of deaths grows exponentially.
&lt;ul&gt;
&lt;li&gt;If this constant is &lt;strong&gt;10&lt;/strong&gt;[%], this means that the numbers of cases
&lt;strong&gt;doubles&lt;/strong&gt; every week.&lt;/li&gt;
&lt;li&gt;A value of about &lt;strong&gt;7&lt;/strong&gt;[%], means a doubling every 10 days.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;A &lt;strong&gt;decreasing&lt;/strong&gt; curve indicates that the exponential growth of
infected people is stalled or reversed.&lt;/li&gt;
&lt;li&gt;If the value approaches &lt;strong&gt;0&lt;/strong&gt;, this indicates that the virus is contained.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;what-it-would-look-like-and-what-it-should-look-like&#34;&gt;What It Would Look Like and What It Should Look Like&lt;/h2&gt;
&lt;p&gt;To have a comparison of what an uncontrolled spread and what a well controlled
spread would look like, we ran two simulations in a covid simulator&lt;sup id=&#34;fnref:5&#34;&gt;&lt;a href=&#34;#fn:5&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;5&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;A scenario for Germany in which no interventions are taken.&lt;/li&gt;
&lt;li&gt;A scenario for which we defined interventions such that the number of
hospitalized patients that require intensive care (ICU) was always below
45000.&lt;/li&gt;
&lt;/ol&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/covid-19-trends/slopes-icus-simulation.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;The daily increase of the accumulated casualties and the numbers of people in need for intensive care due to an infection by COVID-19 for the simulated scenarios. The kink in the red curve is due to the stop of some interventions after 205 days.&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;In the uncontrolled case, exponential growth is detected with a rate of
15[%] of daily increase. After some time, when most people have been infected the, growth decreases
down to zero.&lt;/p&gt;
&lt;p&gt;In the controlled scenario, the rate is brought down in the initial phase. Then,
exponential growth happens at a lower rate (in the plot the value is about 5[%])
though for a longer time before it fades out.&lt;/p&gt;
&lt;p&gt;To relate the slopes to the actual cases, in a second plot, we display the
corresponding numbers of people that will need intensive care in a hospital. In
our model, we assumed that 1.15% of the infected people will have to be treated
in an intensive care unit.&lt;/p&gt;
&lt;h1 id=&#34;the-actual-numbers&#34;&gt;The Actual Numbers&lt;/h1&gt;
&lt;p&gt;We use the JHU for the last 100 days and plot the slopes for the last 90 days.
The moving horizon of 100 days makes the changes of the last 3 months better visible.
By plotting only 90 days, we omit a part of the wiggly behavior in the start of
the data (which however is not relevant for the main part).&lt;/p&gt;
&lt;h2 id=&#34;the-last-100-days&#34;&gt;The last 100 days&lt;/h2&gt;
&lt;p&gt;See the &lt;a href=&#34;slopes-dsifc.pdf&#34;&gt;pdf file&lt;/a&gt; for more countries and a better resolution
of the plots.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/covid-19-trends/slopes-dsifc.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;The daily increase of the accumulated cases (of the last 100 days) for a number of countries. The colored background marks the days where the number of deaths was below 100, 300, 900, 2700, 8100, 24300, ..., respectively. The total number is the number of deaths in the last 100 days. The first 6 countries are always shown. The other 2 countries change occasionally. See the [pdf](slopes-dsifc.pdf) for all countries.&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;!-- ## Explanations of the Data Representation

Because of natural fluctuations and, maybe, because of varying delays in the data
transmission to JHU, the data does not describe a nice, smooth curve.
Accordingly, the computed slopes can vary a lot, what leads to the point clouds
like in the plot for France :fr:. The smoothing effect of the 2 days and 5 days
average makes the corresponding data points look smoother. There are a few
points that lie outside the range of the plots. However, we do not adjust the
plots to fit all outliers, since then the interesting parts of the curve will be
less well resolved. On the other hand, the plot range of China :cn: is
adjusted to better resolve the small numbers. --&gt;
&lt;!--
## Some Interpretation of the JHU Data

As of today, one may say that:

 * In all European countries, the spread of the virus has been slowed down to
   rates well below 0.05. 
 * The curves look all similar, still the overall numbers differ.
 * An indicator for high numbers in casualties are high rates in the phase after
   300 deaths; see *Italy* :it:, *Spain* :es:, *France* :fr:, and the US.
 * In *Germany* :de:, in this phase, the rates were lower than in the countries
   mentioned above.






  
    
  

&lt;div class=&#34;flex px-4 py-3 mb-6 rounded-md bg-primary-100 dark:bg-primary-900&#34;&gt;
&lt;span class=&#34;pr-3 pt-1 text-primary-600 dark:text-primary-300&#34;&gt;
  &lt;svg height=&#34;24&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 24 24&#34;&gt;&lt;path fill=&#34;none&#34; stroke=&#34;currentColor&#34; stroke-linecap=&#34;round&#34; stroke-linejoin=&#34;round&#34; stroke-width=&#34;1.5&#34; d=&#34;m11.25 11.25l.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0a9 9 0 0 1 18 0m-9-3.75h.008v.008H12z&#34;/&gt;&lt;/svg&gt;
&lt;/span&gt;
  &lt;span class=&#34;dark:text-neutral-300&#34;&gt;The plots are updated every day.&lt;/span&gt;
&lt;/div&gt;

## Other Things that can be Seen

 * The curves seem to have similar phases. A phase of exponential growth
   followed by a decrease. 
 * The curves differ in the length of the phases (France seems to have a long
   phase of exponential growth if compared to Spain) 
 * And the starting points are different which gives a hint on when the outbreak
   became visible in the different countries.
--&gt;
&lt;h2 id=&#34;the-last-30-days&#34;&gt;The last 30 days&lt;/h2&gt;
&lt;p&gt;Since we look at the relative growth, so called &lt;em&gt;saturation effects&lt;/em&gt; will make
changes less visible. This happens in particular, with a high number of
cases but a low number of active cases. In the long run, exponential growth
will still be visible, but also the short term dynamics are of interest. For
example, to spot the start of a &lt;em&gt;second wave&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;That&amp;rsquo;s why the following plots consider the daily numbers for the last 40 days
(leaving aside all cases that happened before)
and show the daily increase of the number cases in percent for the last 30 days.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/covid-19-trends/lmslps-dsifc.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;The daily change accumulated cases (in percent, counting from 40 days ago) for a number of countries and the total numbers of cases for the last month. The first 5 countries are always shown. The other 3 countries change occasionally. See the [pdf](lmslps-dsifc.pdf) for all countries.&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h1 id=&#34;notes-and-acknowledgements&#34;&gt;Notes and Acknowledgements&lt;/h1&gt;
&lt;!-- ### On the data
Certainly, the casualties lag[^3] behind the actual spreading of the virus by a
number of days. However, one may think that numbers of casualties are a more
reliable data point than the number of infected.
--&gt;
&lt;h3 id=&#34;disclaimer&#34;&gt;Disclaimer&lt;/h3&gt;
&lt;p&gt;This analysis is purely based on empirical trends. No statistical data analysis
tools have been applied to (pre-)process the data, like data denoising (except
that some outliers might not be shown because of the plot margins).&lt;/p&gt;
&lt;h3 id=&#34;acknowledgements&#34;&gt;Acknowledgements&lt;/h3&gt;
&lt;p&gt;The initial work, namely making the data easily available in python as well as
the code that produces the title picture, was done by Petar Mlinarić.&lt;/p&gt;
&lt;!--Particular help in terms of improving the presentation
was provided by [Christian Himpe](https://himpe.science/), [Tim
Mitchell](http://www.timmitchell.com/), and Peter Benner. --&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;Updates once a day in the morning.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;The plot is by the Italian Physicist &lt;a href=&#34;http://chimera.roma1.infn.it/FEDERICO/Contacts.html&#34;&gt;Prof. Ricci-Tersenghi&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;The basis is not too important here. If one takes 2, then a value of 1
means a doubling. A different basis would only scale the plots but not change the
qualitative outcomes.&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:4&#34;&gt;
&lt;p&gt;&lt;a href=&#34;https://de.wikipedia.org/wiki/Verkehrstod#Deutschland&#34;&gt;https://de.wikipedia.org/wiki/Verkehrstod#Deutschland&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:5&#34;&gt;
&lt;p&gt;&lt;a href=&#34;http://covidsim.eu/&#34;&gt;covidsim.eu&lt;/a&gt; with parameters as recorded in the
screenshots &lt;a href=&#34;covidsim-1-2020-03-22.png&#34;&gt;1&lt;/a&gt; and &lt;a href=&#34;covidsim-2-2020-03-22.png&#34;&gt;2&lt;/a&gt;
based on the assumptions used of the RKI publication mentioned in the footnote
below.&amp;#160;&lt;a href=&#34;#fnref:5&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>FEniCS Burgers POD DMD</title>
      <link>https://www.janheiland.de/post/fenics-burger-pod-dmd/</link>
      <pubDate>Sat, 07 Mar 2020 15:26:18 +0100</pubDate>
      <guid>https://www.janheiland.de/post/fenics-burger-pod-dmd/</guid>
      <description>&lt;details class=&#34;print:hidden xl:hidden&#34; &gt;
  &lt;summary&gt;Table of Contents&lt;/summary&gt;
  &lt;div class=&#34;text-sm&#34;&gt;
  &lt;nav id=&#34;TableOfContents&#34;&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&#34;#the-spatial-discretization-in-fenics&#34;&gt;The spatial discretization in FEniCS&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#the-runge-kutta-time-integration&#34;&gt;The Runge-Kutta Time Integration&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/nav&gt;
  &lt;/div&gt;
&lt;/details&gt;
&lt;h1 id=&#34;burgers-equation&#34;&gt;Burgers equation&lt;/h1&gt;
&lt;p&gt;For a given viscosity parameter $\nu$ and for time $t&gt;0$, we consider the 2D Burgers equation on the unit square&lt;/p&gt;
$$
\frac {\partial}{\partial t}u + (u\nabla)u - \nu \Delta u = 0
$$
&lt;p&gt;with zero Neumann boundary conditions and initial condition&lt;/p&gt;
$$
u\bigr| _ {t=0}(x _ 1, x _ 2) = 
\begin{bmatrix}
 1 \\\\ 1 
\end{bmatrix}
e ^ {-(4x _ 1^2 + 2x _ 2^2)}
$$
&lt;p&gt;and its numerical approximation using&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Finite Elements in space and Runge-Kutta in time,&lt;/li&gt;
&lt;li&gt;a POD reduction of the FEM model, and&lt;/li&gt;
&lt;li&gt;a DMD reduced order model.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;flex px-4 py-3 mb-6 rounded-md bg-primary-100 dark:bg-primary-900&#34;&gt;
&lt;span class=&#34;pr-3 pt-1 text-primary-600 dark:text-primary-300&#34;&gt;
  &lt;svg height=&#34;24&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 24 24&#34;&gt;&lt;path fill=&#34;none&#34; stroke=&#34;currentColor&#34; stroke-linecap=&#34;round&#34; stroke-linejoin=&#34;round&#34; stroke-width=&#34;1.5&#34; d=&#34;m11.25 11.25l.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0a9 9 0 0 1 18 0m-9-3.75h.008v.008H12z&#34;/&gt;&lt;/svg&gt;
&lt;/span&gt;
  &lt;span class=&#34;dark:text-neutral-300&#34;&gt;Check &lt;a href=&#34;burgers.py&#34;&gt;&lt;code&gt;burgers.py&lt;/code&gt;&lt;/a&gt; for the presented code (and more) in one file.&lt;/span&gt;
&lt;/div&gt;
&lt;h1 id=&#34;0-the-setup&#34;&gt;0. The Setup&lt;/h1&gt;
&lt;p&gt;We start with importing the necessary modules and defining the parameters.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;dolfin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;scipy.linalg&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;spla&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;plt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;numpy&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;scipy.integrate&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;solve_ivp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;spacetime_galerkin_pod.ldfnp_ext_cholmod&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SparseFactorMassmat&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;parameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linear_algebra_backend&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Eigen&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;nu&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1e-4&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# the viscosity&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;N&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;poddim&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;t0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Nts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;.8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# the time grid for the snapshots&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;timegrid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;linspace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Nts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here, &lt;code&gt;dolfin&lt;/code&gt; is the python interface to &lt;a href=&#34;https://fenicsproject.org/&#34;&gt;FEniCS&lt;/a&gt;
and the other modules are standard in python, I would say. The module
&lt;code&gt;ldfnp_ext_cholmod&lt;/code&gt; is a little wrapper for the sparsity optimizing Cholesky
decomposition of &lt;a href=&#34;https://github.com/scikit-sparse/scikit-sparse&#34;&gt;&lt;em&gt;sksparse&lt;/em&gt;&lt;/a&gt;.
It is available on &lt;a href=&#34;https://github.com/highlando/spacetime_galerkin_pod&#34;&gt;github&lt;/a&gt;
and falls back to &lt;code&gt;numpy&lt;/code&gt; routines, in the case that &lt;code&gt;sksparse&lt;/code&gt; is not
available.&lt;/p&gt;
&lt;h1 id=&#34;1-the-fem-discretization&#34;&gt;1. The FEM Discretization&lt;/h1&gt;
&lt;h2 id=&#34;the-spatial-discretization-in-fenics&#34;&gt;The spatial discretization in FEniCS&lt;/h2&gt;
&lt;p&gt;First, the mesh is defined &amp;ndash; here a uniform triangulation of the unit square
controlled by the parameter &lt;code&gt;N&lt;/code&gt;. For the value &lt;code&gt;N=80&lt;/code&gt; and for globally smooth
and piecewise quadratic ansatz functions, the resulting dimension of the system
is 51842.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# The mesh&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pone&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Point&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ptwo&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Point&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mesh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;RectangleMesh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ptwo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;V&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;VectorFunctionSpace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mesh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;CG&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ## The FENICS FEM Discretization&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TestFunction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;u&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TrialFunction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Next, the discrete linear operators are defined and exported as a &lt;em&gt;SciPy&lt;/em&gt; sparse
matrix. Also, we factorize the mass matrix &lt;code&gt;mmat&lt;/code&gt; for later use and define the
norm that is weighted with the mass matrix as this is the discrete $L^2$ norm.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ## the mass matrix&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mform&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;massm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;assemble&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mform&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mmat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_backend_type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;massm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sparray&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mmat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eliminate_zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# factorize it for later&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mfac&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;SparseFactorMassmat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mmat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# norm induced by the mass matrix == discrete L2-norm&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;mnorm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uvec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sqrt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uvec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mmat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uvec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ## the stiffness matrix&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# as a form in FEniCS&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;aform&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nu&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;aassm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;assemble&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aform&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# as a sparse matrix&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;amat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;as_backend_type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aassm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sparray&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;amat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eliminate_zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then we define the convective term as function of the velocity &lt;code&gt;u&lt;/code&gt; both in terms
of an FE-function and as a function of the associated coefficient vector.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ## the convective term&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# as a function in FEniCS&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;burgers_nonl_func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ufun&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;cform&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grad&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ufun&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ufun&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;cass&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;assemble&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cform&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# as a vector to form map&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;burgers_nonl_vec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uvec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;ufun&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;ufun&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;uvec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;bnlform&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;burgers_nonl_func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ufun&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;bnlvec&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bnlform&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bnlvec&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;!-- Another helper function that interfaces to *FEniCS* is defined to use the
`dolfin` functionalities to compute the modulus $u_1^2 + u_2^2$ of the vector
field $u$ and to plot it.


```python
def plotabs(uvec, fignum=None, vmax=None,
            sprws=1, spcls=1, spidx=1, colormap=&#39;plasma&#39;):
    ufun = dolfin.Function(V)
    ufun.vector().set_local(uvec)
    plt.figure(fignum)
    plt.subplot(sprws, spcls, spidx)
    cplt = dolfin.plot(dolfin.inner(ufun, ufun))
    cplt.set_cmap(colormap)
    if vmax is not None:
        cplt.set_clim(vmin=0, vmax=vmax)
    plt.colorbar(cplt)
```
--&gt;
&lt;h2 id=&#34;the-runge-kutta-time-integration&#34;&gt;The Runge-Kutta Time Integration&lt;/h2&gt;
&lt;p&gt;To apply standard time integration schemes (here, &lt;code&gt;RK23&lt;/code&gt; turned out to be most
efficient), we define the &lt;em&gt;right hand side&lt;/em&gt; $f_h$ of the spatially discretized problem&lt;/p&gt;
$$
\dot u_h = f_h (t_h, u_h).
$$
&lt;p&gt;In this case the &lt;em&gt;right hand side&lt;/em&gt; is an application of the discrete diffusion
and convection operator and the inverse of the mass matrix that, simply
speaking, maps a (discrete) form onto a discrete function. Note that there is no
explicit time dependency in the Burgers equation, but the &lt;em&gt;SciPy&lt;/em&gt;&amp;rsquo;s &lt;code&gt;solve_ivp&lt;/code&gt;
requires this parameter. Also, we define the initial value here. The time grid
is used to store the solution for the snapshots needed later, but the time
integrator uses his internal time grid.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;inivstrg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;exp(-3.*(x[0]*x[0]+x[1]*x[1]))&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;inivexpr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inivstrg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inivstrg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;degree&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;inivfunc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dolfin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interpolate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inivexpr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;V&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;inivvec&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inivfunc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;burgsol&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;solve_ivp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;brhs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inivvec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t_eval&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;timegrid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;RK23&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fullsol&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;burgsol&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here is the result. Note the sharp front that develops towards the end of the time
integration.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/fenics-burger-pod-dmd/fullsol.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;Solution snapshots of the full FEM model&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h1 id=&#34;2-pod-reduced-model&#34;&gt;2. POD Reduced Model&lt;/h1&gt;
&lt;p&gt;If one has snapshots of the solution $v _ h$ at some time instances $t _ i$ one
may well think that the span of the matrix of snapshots&lt;/p&gt;
$$
X = 
\begin{bmatrix}
v _ h(t_0) &amp; v _ h(t_1) &amp; \dotsm &amp; v _ h(t_k)
\end{bmatrix}
$$
&lt;p&gt;is a good candidate for a space in which the solution evolves in. One may even
go further and look for a low-dimensional basis of this space. The span of a
matrix is best approximated by its dominant singular vectors. And this is the idea of
&lt;em&gt;Proper Orthogonal Decomposition&lt;/em&gt; (POD) &amp;ndash; use the leading singular vectors as a
basis for the solution space.&lt;/p&gt;
&lt;p&gt;We use the &lt;code&gt;Nts=101&lt;/code&gt; snapshots of the FEM solutions to setup the matrix of
measurements $X$ and to compute the POD modes as $M^{-1/2}v _ k$, where $v _ k$
is the $k$-th leading left singular vector of $M^{1/2}X$. This procedure gives a
low-dimensional orthogonal (in the discrete $L^2$ inner product) basis that
optimally parametrizes the subspace of $L^2$ that is spanned by the solution
snapshots&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;. In this example, we use the &lt;code&gt;poddim=30&lt;/code&gt; leading singular vectors
to define the reduced model.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;snapshotmat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mfac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;burgsol&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;podmodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;svals&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;spla&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;svd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;snapshotmat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;full_matrices&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;selected_podmodes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;podmodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;poddim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;podvecs&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mfac&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;solve_Ft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;selected_podmodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In this implementation we use a sparse factor of the mass matrix instead of the
square root.  The singular values (in particular those that correspond to the
discarded directions) give an indication of how good the approximation is.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/fenics-burger-pod-dmd/svs.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;The singular values of the snapshot matrix&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Here, the decay is comparatively slow, so that a one should not expect a good
low dimensional approximation by POD.&lt;/p&gt;
&lt;p&gt;For the simulation, the state is parametrized by $u_h (t) \approx V \tilde
u_h(t)$ where $V$ is the matrix of the POD modes (in the code $V$ denoted by
&lt;code&gt;podvecs&lt;/code&gt;), which gives a system in $\tilde u _ h$ with 30 degrees of freedom
(as opposed to the 51842 of the full order model).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;redamat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;podvecs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;amat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;podvecs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# the projected stiffness&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;redbrhs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redvec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;inflatedv&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;podvecs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;redvec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;redconv&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;podvecs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;burgers_nonl_vec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inflatedv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;redamat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;redvec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redconv&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flatten&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here we define the projected stiffness matrix and the reduced nonlinearity
through&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;inflating the reduced state to full dimension&lt;/li&gt;
&lt;li&gt;applying the nonlinearity&lt;/li&gt;
&lt;li&gt;projecting down the result.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This means that our model is not completely independent of the full dimension.
For this problem there are &lt;em&gt;hyperreduction&lt;/em&gt; techniques like DEIM.&lt;/p&gt;
&lt;p&gt;Thus, the &lt;em&gt;right hand side&lt;/em&gt; is readily defined the more that the projected mass
matrix is the identity. Why?&lt;/p&gt;
&lt;p&gt;Finally, the initial value is projected into the reduced coordinates and the
reduced system is integrated in time.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;redburgsol&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;solve_ivp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;redbrhs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prjinivvec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                       &lt;span class=&#34;n&#34;&gt;t_eval&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;timegrid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;RK23&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;podredsol&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;redburgsol&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In the solution we see that the reduced order model gives a decent approximation
in the smooth regime in the beginning and even well approaches the front as can
be seen in the error (log) plot.&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/fenics-burger-pod-dmd/podsol.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;Snapshots of the solution of the reduced system&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/fenics-burger-pod-dmd/podfullerrlog.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;Snapshots of the log of the error between the full and the POD solution&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;h1 id=&#34;3-dmd-reduced-model&#34;&gt;3. DMD Reduced Model&lt;/h1&gt;
&lt;p&gt;POD is partially data driven &amp;ndash; it uses data to create a basis but still
uses (a projection of) the model. If only snapshots but no model is given, one
may use the method of &lt;em&gt;Dynamic Mode Decomposition&lt;/em&gt;&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt; (DMD) that tries to identify
a matrix $A$ that evolves the state like&lt;/p&gt;
$$
A v _ h (t_i) = v _ h (t _ {i+1})
$$
&lt;p&gt;In practice, one uses a set of snapshots and the two measurement matrices&lt;/p&gt;
$$
X = 
\begin{bmatrix}
v _ h(t_0) &amp; v _ h(t_1) &amp; \dotsm &amp; v _ h(t _ {k-1})
\end{bmatrix}
$$
&lt;p&gt;
and
&lt;/p&gt;
$$
X&#39; =
\begin{bmatrix}
v _ h(t_1) &amp; v _ h(t_2) &amp; \dotsm &amp; v _ h(t _ {k})
\end{bmatrix}.
$$
&lt;p&gt;Note that $X&#39;$ is basically $X$ shifted by one time step.&lt;/p&gt;
&lt;p&gt;Then the DMD matrix can be found by solving the linear regression problem&lt;/p&gt;
$$
\min _ P \| X&#39; - PX \| _ F.
$$
&lt;p&gt;For the reduced DMD model we use the same snapshot matrix as for the POD. The
regression problem is solved via SVD to compute the needed pseudo inverse since
this naturally allows for a rank reduction and a factored representation of the
DMD matrix.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ### dmd using truncated svd inverse&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fburgsol&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;burgsol&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Xmat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fburgsol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Xdsh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fburgsol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ux&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vxh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;spla&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;svd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Xmat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;full_matrices&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;uxr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sxr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vxhr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ux&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;poddim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;poddim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vxh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;poddim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# compute the dmd matrix in factored form: `dmda = dmdaone * dmdatwo`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dmdaone&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Xdsh&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vxhr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dmdatwo&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;linalg&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;solve&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;diag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sxr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;uxr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Once the DMD matrix $A$ is determined, the simulation of the DMD reduced model
is only a repeated multiplication by $A$.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# simulation of the dmd reduced model&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dmdxo&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inivvec&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dmdsol&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dmdxo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;dmdsol&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dmdaone&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dmdatwo&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dmdsol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dmdsol&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dmdsol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As can be seen from the results and the error plots, DMD does a good job in the
initial phase but fails in the region with the sharp front.&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/fenics-burger-pod-dmd/dmdsol.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;Snapshots of the DMD solution&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/fenics-burger-pod-dmd/dmdfullerrlog.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;Error (log) plot with respect to the full FEM solution&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;h1 id=&#34;4-testing-the-models-for-different-initial-value&#34;&gt;4. Testing the Models for Different Initial Value&lt;/h1&gt;
&lt;p&gt;In what was presented above, the reduced models were used to reproduce the
states that they were trained on. We now check the given reduced order models
but on an alternative initial value, namely&lt;/p&gt;
$$
u\bigr| _ {t=0}(x _ 1, x _ 2) = 
\begin{bmatrix}
 1 \\\\ 1 
\end{bmatrix}
e ^ {-(2x _ 1^2 + 4x _ 2^2)}
$$
&lt;p&gt;see the following two plots of the full order model for both initial values.&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/fenics-burger-pod-dmd/fullsol.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;Solution snapshots of the full FEM model&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;b-fullsol.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;Solution snapshots of the full FEM model with the alternative initial value&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Then we use the reduced order models to compute predictions for the trajectory
starting in this alternative initial value.&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/fenics-burger-pod-dmd/b-podsol.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;Snapshots of the solution of the POD reduced system starting in the alternative initial value.&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://www.janheiland.de/post/fenics-burger-pod-dmd/b-dmdsol.png&#34;&gt;&lt;figcaption&gt;
      &lt;h4&gt;Snapshots of the DMD solution starting in the alternative initial value.&lt;/h4&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Both methods completely fail to produce the other trajectory. For the POD
reduced model already the starting point is extremely bad approximated.
Interestingly, although the DMD solution starts in the &lt;em&gt;right&lt;/em&gt; point, it seems
to exactly reproduce the solution that it was trained on up to some additional
oscillations.&lt;/p&gt;
&lt;h1 id=&#34;5-remarks&#34;&gt;5. Remarks&lt;/h1&gt;
&lt;p&gt;It is commonly accepted that POD does not work well for transport dominated
problems &amp;ndash; like the current case with the low viscosity parameter &lt;code&gt;nu=1e-4&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;So, I think that the results for POD are quite good noting that the reduced
order model has 30 degrees of freedom whereas the full model has 51842.
In my tests, increasing the number of basis functions as well as considering a
larger &lt;code&gt;nu&lt;/code&gt; led to better POD approximations.&lt;/p&gt;
&lt;p&gt;The DMD approach shows a similar performance. If compared to POD, the
qualitative approximation looks less good but the numbers are slightly better.
All in all, the DMD approximation seems less reliable as for other parameter
choices, the performance rather deteriorated than improved.&lt;/p&gt;
&lt;p&gt;How challenging the problem of 2D Burgers with a low viscosity is, can be seen
from the failure of both methods to produce useable approximations to
trajectories that start in different initial values.&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;See, e.g., Lemma 2.5 of Baumann, Benner, and Heiland (2018): &lt;em&gt;Space-Time Galerkin POD with Application in Optimal Control of Semi-linear Parabolic Partial
Differential Equations.&lt;/em&gt; &lt;a href=&#34;https://arxiv.org/abs/1611.04050&#34;&gt;arXiv:1611.04050&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;See, e.g., Tu, Rowley, Luchtenburg, Brunton, Kutz (2013): &lt;em&gt;On Dynamic Mode
Decomposition: Theory and Applications&lt;/em&gt; &lt;a href=&#34;https://arxiv.org/abs/1312.0041&#34;&gt;arXiv:1312.0041&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Adjoint Systems for Optimal Control from Pontryagin to Wikipedia</title>
      <link>https://www.janheiland.de/post/pontr-pendl/</link>
      <pubDate>Tue, 06 Aug 2019 17:34:51 +0200</pubDate>
      <guid>https://www.janheiland.de/post/pontr-pendl/</guid>
      <description>&lt;p&gt;While it seems common knowledge how to formulate &lt;em&gt;necessary optimality&lt;/em&gt;
conditions backed by the famous &lt;em&gt;Pontryagin&amp;rsquo;s Maximum Principle&lt;/em&gt;, the direct
derivation from the &lt;strong&gt;very general&lt;/strong&gt; original formulations is not obvious.
Sometimes, authors like me&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; provide some plausibility like &lt;em&gt;obviously this
term has to vanish&lt;/em&gt;, refer to other sources that miss the derivation too, or
attach the complete book by Pontryagin to a specific formula&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;details class=&#34;print:hidden xl:hidden&#34; &gt;
  &lt;summary&gt;Table of Contents&lt;/summary&gt;
  &lt;div class=&#34;text-sm&#34;&gt;
  &lt;nav id=&#34;TableOfContents&#34;&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&#34;#a-unit-pendulum&#34;&gt;A Unit Pendulum&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&#34;#final-state-fixed&#34;&gt;Final State Fixed&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#final-state-as-optimization-target&#34;&gt;Final State as Optimization Target&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&#34;#maximum-principle-with-variable-endpoints&#34;&gt;Maximum Principle with Variable Endpoints&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#the-wikipedia-case&#34;&gt;The Wikipedia Case&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&#34;#i-lagrange-form&#34;&gt;I. Lagrange form&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#ii-pontryagins-terms&#34;&gt;II. Pontryagin&amp;rsquo;s terms&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#iii-pontryagin-with-variable-endpoints&#34;&gt;III. Pontryagin with variable endpoints&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/nav&gt;
  &lt;/div&gt;
&lt;/details&gt;
&lt;h1 id=&#34;the-model&#34;&gt;The Model&lt;/h1&gt;
&lt;h2 id=&#34;a-unit-pendulum&#34;&gt;A Unit Pendulum&lt;/h2&gt;
&lt;p&gt;Consider the pendulum subjected to a potential force that can be adjusted. That is, instead of the gravity&lt;/p&gt;
$$
G:= 
\begin{bmatrix}
0\\\\ -9.81
\end{bmatrix},
$$
&lt;p&gt;we consider a force field&lt;/p&gt;
$$
G:= 
\begin{bmatrix}
g_1 \\\\  g_2
\end{bmatrix},
$$
&lt;p&gt;with scalar functions $g_1$, $g_2$ of time that can act as a control.&lt;/p&gt;
&lt;p&gt;With mass $m$, length $L$, and angle $\theta$ (see the picture below), we define the momentum as&lt;/p&gt;
$$
p = mL^2\dot \theta.
$$
&lt;p&gt;This gives the Hamiltonian
&lt;/p&gt;
$$
 H(\theta, p) = \frac{p^2}{2mL^2} + m 
\begin{bmatrix}
g_1 &amp;g_2
\end{bmatrix}
\begin{bmatrix}
L \sin \theta \\\\ -L \cos \theta
\end{bmatrix}, 
$$
&lt;p&gt;or
&lt;/p&gt;
$$
H(\theta, p)= \frac{p^2}{2mL^2} + mg_1 L \sin \theta - mg_2 \cos \theta ,
$$
&lt;p&gt;and the equations of motion as&lt;/p&gt;
&lt;p&gt;$
\begin{aligned}
\quad \quad \quad \dot \theta &amp;= \frac{p}{mL^2}, 
\\\\\\\\
\dot p &amp;= -mg_1L\cos \theta - mg_2L\sin \theta.
\end{aligned}
$&lt;/p&gt;
&lt;p&gt;Here is a schematic illustration taken from &lt;a href=&#34;http://www.scholarpedia.org/article/File:Pendulum.png&#34;&gt;scholarpedia&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;Pendulum.png&#34; alt=&#34;pendulum, taken from scholarpedia&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;control-setups&#34;&gt;Control Setups&lt;/h1&gt;
&lt;p&gt;With consider two control setups:&lt;/p&gt;
&lt;h2 id=&#34;final-state-fixed&#34;&gt;Final State Fixed&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Fix a time $t_1$, start with &lt;br&gt;
$\quad(\theta(t_0), p(t_0))=(\pi, 0)$,&lt;br&gt; i.e. pendulum standing up-side-down,
and minimize the control effort &lt;br&gt;
$ \quad \mathcal J:= \frac{1}{2}\int_{t_0}^{t_1} g_1^2 + g_2^2 ~ dt \to \min $&lt;br&gt;
over all $(g_1, g_2)$ that lead to &lt;br&gt;
$\quad(\theta(t_1), p(t_1))=(0,0)$,&lt;br&gt; i.e. pendulum hanging down.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;final-state-as-optimization-target&#34;&gt;Final State as Optimization Target&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Fix a time $t_1$, start with &lt;br&gt;
$\quad(\theta(t_0), p(t_0))=(\pi, 0)$,&lt;br&gt; i.e. pendulum standing up-side-down,
and find a control that targets &lt;br&gt;
$\quad (\theta(t_1), p(t_1))=(0,0)$,&lt;br&gt;
i.e. pendulum hanging down
while also minimizing the control effort:&lt;br&gt;
$ \quad \mathcal J:= \frac{1}{2}(\theta(t\_1)^2 + p(t\_1)^2) + \frac{1}{2}\int_{t_0}^{t_1} g_1^2 + g_2^2 ~ dt \to \min $.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;the-maximum-principle&#34;&gt;The Maximum Principle&lt;/h1&gt;
&lt;p&gt;Classically, as treated by Pontryagin itself&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;, one seeks the minimum over all $u=(g_1, g_2)$ that &lt;em&gt;a-priori&lt;/em&gt; ensure that $\theta(t_1)=0$ and $p(t_1)=0$. This, in a sense, means that suitable controls are known and that the optimization looks for those with the least magnitude. For people like me, that use optimization because they don&amp;rsquo;t know a control, this seems not very feasible. But Pontryagin has the answer for that too:&lt;/p&gt;
&lt;h2 id=&#34;maximum-principle-with-variable-endpoints&#34;&gt;Maximum Principle with Variable Endpoints&lt;/h2&gt;
&lt;p&gt;One can (partially) abandon the end conditions, see Chapter I.7 in Pontryagin&amp;rsquo;s book. Similarly, one can abandon the initial conditions which, again, seems odd from an application point of view. Also, simply omitting the end conditions will lead to trivial solutions. Certainly, we need to include them in the optimization. Which leads to the Wikipedia case.&lt;/p&gt;
&lt;h2 id=&#34;the-wikipedia-case&#34;&gt;The Wikipedia Case&lt;/h2&gt;
&lt;p&gt;Commonly used and illustrated on &lt;a href=&#34;https://en.wikipedia.org/wiki/Pontryagin%27s_maximum_principle#Formal_statement_of_necessary_conditions_for_minimization_problem&#34;&gt;wikipedia:Pontryagin&amp;rsquo;s maximum principle&lt;/a&gt;
&amp;ndash; the form that leaves the controls free but penalizes the endpoint. Now, let me show how this form derives from Pontryagin&amp;rsquo;s book.&lt;/p&gt;
&lt;h1 id=&#34;connecting-wikipedia-and-pontryagin&#34;&gt;Connecting Wikipedia and Pontryagin&lt;/h1&gt;
&lt;p&gt;The derivation of the &lt;em&gt;Wikipedia&lt;/em&gt; formulas from the &lt;em&gt;Maximum Principle with Variable Endpoints&lt;/em&gt; goes as follows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Transform (see, e.g., &lt;a href=&#34;https://www.encyclopediaofmath.org/index.php/Bolza_problem&#34;&gt;Enc. of Math.: Bolza problem&lt;/a&gt;) the problem from &lt;em&gt;Mayer form&lt;/em&gt; to &lt;em&gt;Lagrange form&lt;/em&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Put the resulting system into the form of &lt;em&gt;Pontryagin&lt;/em&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Apply the maximum principle with completely free endpoints.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;For the pendulum optimal control problem&lt;/p&gt;
$$\frac{1}{2}(\theta(t\_1)^2 + p(t\_1)^2) +\frac{1}{2}\int_{t_0}^{t\_1} g_1^2 + g\_2^2 \;dt \to \min$$
&lt;p&gt;subject to&lt;/p&gt;
$$
\begin{aligned}
\dot \theta &amp;= \frac{p}{mL^2},\\\\\\\\
\dot p &amp;= -mg_1L\cos \theta - mg_2L\sin \theta.
\end{aligned}
$$
&lt;p&gt;with initial conditions&lt;/p&gt;
$$
\theta(t_0)=\pi, \quad p(t_0)=0
$$
&lt;p&gt;this means:&lt;/p&gt;
&lt;h2 id=&#34;i-lagrange-form&#34;&gt;I. Lagrange form&lt;/h2&gt;
&lt;p&gt;We get rid of the costs that are put on the terminal values by introducing a variable $\tilde x$. Thus the optimal control problem no reads:&lt;/p&gt;
$$
\mathcal J:=\int_{t_0}^{t_1} \tilde x + \frac{1}{2}(g_1^2+g_2^2) \;dt \to \min
$$
&lt;p&gt;subject to&lt;/p&gt;
$$
\begin{aligned}
\dot {\tilde x} &amp;= 0, \\\\\\\\
\dot \theta &amp;= \frac{p}{mL^2},\\\\\\\\
\dot p &amp;= -mg_1L\cos \theta - mg_2L\sin \theta.
\end{aligned}
$$
&lt;p&gt;with one end condition&lt;/p&gt;
$$
\tilde x(t_1) = \frac{1}{2(t_1-t_0)}(\theta(t_1)^2+p(t_1)^2), 
$$
&lt;p&gt;and the old initial conditions&lt;/p&gt;
$$
\theta(t_0)=\pi, \quad p(t_0)=0.
$$
&lt;blockquote&gt;
&lt;p&gt;In fact, since $\tilde x$ is constant and fixed by its end condition, one obtains that&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;$\int_{t_0}^{t_1} \tilde x \;dt = (t_1 - t_0)\tilde x(t_1) = \frac{1}{2}(\theta(t_1)^2+p(t_1)^2).$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Once in &lt;em&gt;Lagrange&lt;/em&gt; form, the problem can be put into the form used in Pontryagin&amp;rsquo;s theorem:&lt;/p&gt;
&lt;h2 id=&#34;ii-pontryagins-terms&#34;&gt;II. Pontryagin&amp;rsquo;s terms&lt;/h2&gt;
$$
x^0(t_1) \to \min
$$
&lt;p&gt;subject to&lt;/p&gt;
$$
\begin{aligned}
\dot x^0 &amp;= \tilde x + \frac{1}{2}(g_1^2+g_2^2), \\\\\\\\
\dot {\tilde x} &amp;= 0, \\\\\\\\
\dot \theta &amp;= \frac{p}{mL^2},\\\\\\\\
\dot p &amp;= -mg_1L\cos \theta - mg_2L\sin \theta.
\end{aligned}
$$
&lt;p&gt;with initial conditions&lt;/p&gt;
&lt;p&gt;\begin{equation}
x^0(t_0)=0, \quad \theta(t_0)=\pi, \quad p(t_0)=0,
\end{equation}&lt;/p&gt;
&lt;p&gt;and the end condition&lt;/p&gt;
$$
\tilde x(t_1) = \frac{1}{2(t_1-t_0)}(\theta(t_1)^2+p(t_1)^2).
$$
&lt;blockquote&gt;
&lt;p&gt;Here, the trick is that the new variable $x^0$ simply integrates the value of the cost functional.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The corresponding adjoint system for the $\psi$ reads&lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;\begin{align}
\dot \psi_0 &amp;amp;= 0, \\\\
\dot \psi_1 &amp;amp;= -\psi_0, \\\\
\dot \psi_2 &amp;amp;= -(mg_1L\sin\theta - mg_2L\cos\theta) \psi_3, \\\\
\dot \psi_3 &amp;amp;= -\frac{1}{mL^2}\psi_2.
\end{align}&lt;/p&gt;
&lt;p&gt;This $\psi$ defines the control Hamiltonian as&lt;/p&gt;
$$
\bigl(\psi, f(x;G) \bigl ) =
\bigl(\psi, 
\begin{bmatrix}
 \tilde x + \frac{1}{2}(g_1^2+g_2^2) \\\\\\\\
 0 \\\\\\\\
 \frac{p}{mL^2}\\\\\\\\
 -mg_1L\cos \theta - mg_2L\sin \theta
     \end{bmatrix}
\bigl )
$$
&lt;h2 id=&#34;iii-pontryagin-with-variable-endpoints&#34;&gt;III. Pontryagin with variable endpoints&lt;/h2&gt;
&lt;p&gt;Finally, we can omit parts of the end conditions.&lt;/p&gt;
&lt;p&gt;If we let the state $(\tilde x, \theta, p)$ at $t_1$ take on an arbitrary value then it will belong to the hypersurface&lt;/p&gt;
$$
S_1 = \{(\frac{1}{2(t_1-t_0)}(\theta^2 + p^2), \theta, p)\} \subset \mathbb R^3
$$
&lt;p&gt;Then the &lt;em&gt;transversality condition&lt;/em&gt;&lt;sup id=&#34;fnref:5&#34;&gt;&lt;a href=&#34;#fn:5&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;5&lt;/a&gt;&lt;/sup&gt; that $\psi(t_1)$ has to be &lt;em&gt;orthogonal&lt;/em&gt; to the tangent plane to $S_1$ at $(\tilde x(t_1), \theta(t_1), p(t_1))$ gives the following boundary conditions for $\psi$:&lt;/p&gt;
&lt;p&gt;\begin{align}
\frac{1}{t_1-t_0}p(t_1)\psi_1(t_1) - \psi_3(t_1) &amp;amp;= 0, \\\\
\frac{1}{t_1-t_0}\theta(t_1)\psi_1(t_1) - \psi_2(t_1) &amp;amp;= 0.
\end{align}&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;These give the &lt;em&gt;Wikipedia&lt;/em&gt; terminal condition for the adjoint state with the choice of $\psi_1(t_1) = t_1-t_0$.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Note that these particular end conditions were derived from the particular basis&lt;/p&gt;
$$
\biggl\\{
\begin{bmatrix} 
    \frac{1}{t\_1-t\_0}p \\\\ 0 \\\\ 1
\end{bmatrix}, 
\begin{bmatrix} 
    \frac{1}{t_1-t_0}\theta \\\\ 1 \\\\ 0
\end{bmatrix}
\biggr\\}
$$
&lt;p&gt;of the tangent space and note that any other basis can be taken, or equivalently, any linear combination of the boundary conditions are feasible.&lt;/p&gt;
&lt;h1 id=&#34;references&#34;&gt;References&lt;/h1&gt;
&lt;p&gt;&amp;#x1f4d9; Pontryagin, Boltyanski, Gamkrelidze, and Mishchenko (1962) &lt;em&gt;The Mathematical Theory of Optimal Processes&lt;/em&gt;&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;Lemma 6.5 in Heiland (2013) &lt;em&gt;Decoupling, Semi-Discretization, and Optimal
Control of Semi-linear Semi-explicit Index-2 Abstract Differential-Algebraic
Equations and Application in Optimal Flow Control&lt;/em&gt;&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;cp. the text before Theorem 3.4 in Ober-Blöbaum, Junge, Marsden
(2008) &lt;em&gt;Discrete Mechanics and Optimal Control: an Analysis&lt;/em&gt;]&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;Ch. I.2 in his book&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:4&#34;&gt;
&lt;p&gt;Pontryagin et al., Theorem 1&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:5&#34;&gt;
&lt;p&gt;Pontryagin et al., Ch. I.7&amp;#160;&lt;a href=&#34;#fnref:5&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
